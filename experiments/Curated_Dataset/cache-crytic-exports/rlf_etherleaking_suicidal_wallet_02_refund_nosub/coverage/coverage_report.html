<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Medusa Coverage Report</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono&display=swap">
    <style>
        :root {
             
            --primary: #6366f1;
            --primary-hover: #4f46e5;
            --primary-light: rgba(99,102,241,0.1);
            --success: #22c55e;
            --warning: #eab308;
            --danger: #ef4444;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --surface: #fff;
            --text: var(--gray-800);
            --text-light: var(--gray-500);
            --radius: 0.375rem;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow: 0 1px 3px rgba(0,0,0,0.1);
             
            --success-rgb: 34,197,94;
            --warning-rgb: 234,179,8;
            --danger-rgb: 239,68,68;
        }

         
        * {box-sizing:border-box;margin:0;padding:0}
        
        body {
            font-family:'Inter',-apple-system,sans-serif;
            font-size:0.875rem;
            line-height:1.5;
            color:var(--text);
            background:var(--gray-50);
            height:100vh;
            display:flex;
            flex-direction:column;
            overflow:hidden;
        }
        
        a {color:var(--primary);text-decoration:none}
        a:hover {color:var(--primary-hover);text-decoration:underline}
        
        button {
            cursor:pointer;
            background:transparent;
            border:none;
            padding:0;
            font:inherit;
            color:inherit;
            outline:none;
        }
        
         
        .app-container {
            display:flex;
            flex-direction:column;
            height:100vh;
            overflow:hidden;
        }
        
        header {
            background:var(--surface);
            border-bottom:1px solid var(--gray-200);
            padding:1rem 1.5rem;
            z-index:10;
            box-shadow:var(--shadow-sm);
        }
        
        .header-content {
            display:flex;
            align-items:center;
            justify-content:space-between;
            max-width:1400px;
            margin:0 auto;
            width:100%;
        }
        
        .logo-text {
            font-size:1.5rem;
            font-weight:600;
            color:var(--gray-800);
        }
        
         
        .btn {
            display:inline-flex;
            align-items:center;
            justify-content:center;
            height:2.25rem;
            padding:0 1rem;
            font-size:0.875rem;
            font-weight:500;
            border-radius:var(--radius);
            transition:all 0.2s;
            border:1px solid transparent;
        }
        
        .btn-secondary {
            background:#B92B3D;
            border-color:#B92B3D;
            color:white;
        }
        
        .btn-secondary:hover {
            background:#9e2434;
            border-color:#9e2434;
        }
        
        .btn-sm {
            height:2rem;
            padding:0 1rem;
            font-size:0.75rem;
        }
        
        .button-group {
            display:flex;
            gap:0.75rem;
            width:100%;
        }
        
        .button-group .btn {
            flex:1;
        }
        
         
        .split-panel {
            display:flex;
            flex:1;
            overflow:hidden;
            position:relative;
        }
        
        #file-split-panel {
            display:flex;
            flex-direction:row;
        }
        
         
        #file-explorer {
            flex:0 0 260px;
            height:100%;
            overflow:auto;
            background:var(--surface);
            border-right:1px solid var(--gray-200);
            padding:0;
            position:relative;
            min-width:200px;
            max-width:500px;
            display:flex;
            flex-direction:column;
        }
        
        #file-explorer-resizer {
            position:absolute;
            top:0;
            right:-5px;
            width:10px;
            height:100%;
            cursor:col-resize;
            z-index:10;
            background:linear-gradient(to right,transparent,rgba(0,0,0,0.05),transparent);
        }
        
        #file-explorer-resizer:hover {
            background:linear-gradient(to right,transparent,rgba(0,0,0,0.1),transparent);
        }
        
        .file-explorer-header {
            display:flex;
            justify-content:center;
            align-items:center;
            padding:1rem;
            border-bottom:1px solid var(--gray-200);
        }
        
        .file-search {
            padding:0.5rem 1rem;
            border-bottom:1px solid var(--gray-200);
            display:flex;
            align-items:center;
        }
        
        .file-search input {
            flex:1;
            border:1px solid var(--gray-300);
            border-radius:var(--radius);
            padding:0.5rem;
            font-size:0.875rem;
            outline:none;
        }
        
        .file-search input:focus {
            border-color:var(--primary);
            box-shadow:0 0 0 1px var(--primary-light);
        }
        
        #file-search-clear {
            margin-left:0.5rem;
            color:var(--gray-500);
            font-size:1.25rem;
            line-height:1;
            padding:0.25rem;
            border-radius:var(--radius);
        }
        
        #file-search-clear:hover {
            background:var(--gray-100);
        }
        
        .search-highlight {
            background:var(--primary-light);
            color:var(--primary);
            font-weight:500;
        }
        
        .search-no-results {
            padding:1rem;
            font-style:italic;
            color:var(--gray-500);
            text-align:center;
        }
        
        .file-explorer-content {
            overflow:auto;
            flex:1;
            padding:1rem;
        }
        
        .file-explorer-title {
            font-size:0.875rem;
            font-weight:600;
            margin:0;
            color:var(--gray-600);
            text-transform:uppercase;
            letter-spacing:0.05em;
        }
        
         
        #main-view-panel {
            flex:1;
            height:100%;
            overflow:auto;
            padding:1.5rem;
            background:var(--gray-50);
        }
        
         
        .stats-container {
            display:grid;
            grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
            gap:1rem;
            margin-bottom:1.5rem;
        }
        
        .stat-card {
            background:var(--surface);
            border-radius:var(--radius);
            padding:1.25rem;
            box-shadow:var(--shadow);
            display:flex;
            flex-direction:column;
        }
        
        .stat-title {
            font-size:0.875rem;
            color:var(--text-light);
            margin-bottom:0.5rem;
        }
        
        .stat-value {
            font-size:1.5rem;
            font-weight:600;
            margin-bottom:0.5rem;
        }
        
        .stat-badge {
            display:inline-flex;
            align-items:center;
            padding:0.25rem 0.5rem;
            border-radius:9999px;
            font-size:0.75rem;
            font-weight:500;
            background:var(--primary-light);
            color:var(--primary);
        }
        
         
        .progress-container {
            width:100%;
            height:0.5rem;
            background:var(--gray-200);
            border-radius:9999px;
            overflow:hidden;
            margin-top:0.5rem;
        }
        
        .progress-bar {
            height:100%;
            border-radius:9999px;
            transition:width 0.3s;
        }
        
         
        .file-tree {
            list-style:none;
            padding-left:0;
            margin:0;
            font-size:0.875rem;
        }
        
        .file-tree li {
            margin:0.25rem 0;
        }
        
        .file-tree ul {
            list-style:none;
            padding-left:1.25rem;
            margin:0.25rem 0;
        }
        
        .file-item {
            display:flex;
            align-items:center;
            cursor:pointer;
            padding:0.375rem 0.5rem;
            border-radius:var(--radius);
            transition:background-color 0.2s;
        }
        
        .file-item:hover {
            background:var(--gray-100);
        }
        
        .file-item.active {
            background:var(--primary-light);
            color:var(--primary);
        }
        
        .file-toggle {
            width:1.25rem;
            display:flex;
            align-items:center;
            justify-content:center;
            font-size:0.75rem;
            color:var(--gray-500);
        }
        
        .file-icon {
            display:flex;
            align-items:center;
            justify-content:center;
            margin-right:0.5rem;
            color:var(--gray-500);
        }
        
        .file-name {
            flex:1;
            white-space:nowrap;
            overflow:hidden;
            text-overflow:ellipsis;
        }
        
        .file-coverage {
            width:0.75rem;
            height:0.75rem;
            border-radius:50%;
            margin-left:0.5rem;
        }
        
         
        .directory > .file-item > .file-icon:before {content:"ðŸ“"}
        .directory.expanded > .file-item > .file-icon:before {content:"ðŸ“‚"}
        .file > .file-item > .file-icon:before {content:"ðŸ“„"}
        .directory > .file-item > .file-toggle:before {content:"â–¶"}
        .directory.expanded > .file-item > .file-toggle:before {content:"â–¼"}
        .file > .file-item > .file-toggle {visibility:hidden}
        .directory > ul {display:none}
        .directory.expanded > ul {display:block}
        
         
        .source-file {
            margin-bottom:1.5rem;
            border-radius:var(--radius);
            overflow:hidden;
            box-shadow:var(--shadow);
            background:var(--surface);
        }
        
        .source-file-header {
            padding:0.75rem 1rem;
            background:#12181E;
            color:white;
            cursor:pointer;
            display:flex;
            align-items:center;
            justify-content:space-between;
            transition:background-color 0.2s;
        }
        
        .source-file-header:hover {
            background:#1e2832;
        }
        
        .source-file-header .file-info {
            display:flex;
            align-items:center;
            gap:1rem;
        }
        
        .source-file-header .file-name {
            font-weight:500;
        }
        
        .source-file-header .coverage-badge {
            display:inline-flex;
            align-items:center;
            padding:0.25rem 0.5rem;
            border-radius:9999px;
            font-size:0.75rem;
            font-weight:500;
        }
        
        .source-file-content {
            max-height:0;
            overflow:hidden;
            transition:max-height 0.3s ease;
        }
        
        .source-file.expanded .source-file-content {
            max-height:none;
        }
        
        .source-file-stats {
            padding:0.75rem 1rem;
            border-bottom:1px solid var(--gray-200);
            font-size:0.875rem;
            color:var(--text-light);
        }
        
         
        .code-container {
            position:relative;
            overflow:auto;
            max-height:600px;
        }
        
        .code-coverage-table {
            border-collapse:collapse;
            font-family:'JetBrains Mono',monospace;
            font-size:0.8125rem;
            line-height:1.5;
            tab-size:4;
            width:100%;
        }
        
        .code-coverage-table pre {
            margin:0;
            font-family:inherit;
        }
        
        .row-line-number {
            user-select:none;
            text-align:right;
            padding:0 0.75rem;
            width:1%;
            min-width:2.5rem;
            color:var(--gray-400);
            background:var(--gray-100);
            border-right:1px solid var(--gray-200);
        }
        
        .row-reverted-status {
            user-select:none;
            text-align:center;
            width:1%;
            min-width:2.25rem;
            max-width:fit-content;
            padding:0 0.25rem;
            color:var(--gray-600);
            background:var(--gray-100);
            border-right:1px solid var(--gray-200);
            white-space:nowrap;
        }
        
        .row-source {
            padding:0 0.75rem;
        }
        
        .row-line-covered {
            background:rgba(var(--success-rgb),0.1);
        }
        
        .row-line-uncovered {
            background:rgba(var(--danger-rgb),0.1);
        }
        
         
        footer {
            background:var(--surface);
            border-top:1px solid var(--gray-200);
            padding:1rem;
            text-align:center;
            font-size:0.875rem;
            color:var(--gray-500);
        }
        
         
        @media (max-width:768px) {
            .stats-container {grid-template-columns:1fr}
            #file-explorer {display:none}
        }
    </style>
</head>

<body>
    <div class="app-container">
        
        <header>
            <div class="header-content">
                <span class="logo-text">Medusa Coverage Report</span>
                <a href="https://github.com/crytic/medusa" target="_blank" class="btn btn-secondary btn-sm">GitHub</a>
            </div>
        </header>

        
        <div class="split-panel" id="file-split-panel">
            
            <div id="file-explorer">
                <div class="file-explorer-header">
                    <h3 class="file-explorer-title">Files</h3>
                </div>
                <div class="file-search">
                    <input type="text" id="file-search-input" placeholder="Search files..." />
                    <button id="file-search-clear" title="Clear search">Ã—</button>
                </div>
                <div class="file-explorer-content">
                    <ul id="file-tree-root" class="file-tree"></ul>
                    <div id="search-no-results" class="search-no-results" style="display: none;">No matching files found</div>
                </div>
                <div id="file-explorer-resizer"></div>
            </div>
            
            
            <div id="main-view-panel">
                
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-title">Files</div>
                        <div class="stat-value">1</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Total Lines</div>
                        <div class="stat-value">47</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Coverage</div>
                        
                        
                        
                        <div class="stat-value">11.1%</div>
                        <div class="progress-container">
                            <div class="progress-bar" style="width: 11%; background-color: ZgotmplZ"></div>
                        </div>
                        <div style="margin-top: 0.5rem">
                            <span class="stat-badge">1 / 9 lines</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Actions</div>
                        <div class="button-group">
                            <button class="btn btn-secondary btn-sm" onclick="setAllSourceFilesCollapsed(false)">Expand All</button>
                            <button class="btn btn-secondary btn-sm" onclick="setAllSourceFilesCollapsed(true)">Collapse All</button>
                        </div>
                        <div class="button-group" style="margin-top: 0.5rem">
                            <button class="btn btn-secondary btn-sm" onclick="setEmptySourceFilesCollapsed(false)">Expand Empty</button>
                            <button class="btn btn-secondary btn-sm" onclick="setEmptySourceFilesCollapsed(true)">Collapse Empty</button>
                        </div>
                    </div>
                </div>

                
                
                    
                    
                    
                    <div class="source-file" id="_disk1_sujzh3_SmartFuzz_medusa_tmp_experiments_curated_dataset_rlf_etherleaking_suicidal_wallet_02_refund_nosub_sol" data-file-path="../../../dataset/rlf_etherleaking_suicidal/wallet_02_refund_nosub.sol" data-lines-active="9" data-lines-covered="1">
                        <div class="source-file-header">
                            <div class="file-info">
                                <span class="coverage-badge" style="background-color: ZgotmplZ; color: ZgotmplZ">
                                    11.1%
                                </span>
                                <span class="file-name">../../../dataset/rlf_etherleaking_suicidal/wallet_02_refund_nosub.sol</span>
                            </div>
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </div>
                        <div class="source-file-content">
                            <div class="source-file-stats">
                                <span>Lines covered: <strong>1 / 9</strong> (11.1%)</span>
                            </div>
                            <div class="code-container">
                                <table class="code-coverage-table">
                                    
                                        <tr>
                                            <td class="row-line-number">1</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre>/*</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">2</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre> * @source: https://smartcontractsecurity.github.io/SWC-registry/docs/SWC-105#wallet-02-refund-nosubsol</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">3</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre> * @author: -</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">4</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre> * @vulnerable_at_lines: 36</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">5</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre> */</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">6</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre></pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">7</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre> pragma solidity ^0.4.24;</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">8</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre></pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">9</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre> /* User can add pay in and withdraw Ether.</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">10</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre>    Unfortunately the developer forgot set the user&#39;s balance to 0 when refund() is called.</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">11</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre>    An attacker can pay in a small amount of Ether and call refund() repeatedly to empty the contract.</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">12</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre> */</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">13</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre></pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">14</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre> contract Wallet {</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">15</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre>     address creator;</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">16</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre></pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">17</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre>     mapping(address =&gt; uint256) balances;</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">18</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre></pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">19</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre>     constructor() public {</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">20</td>
                                            <td class="row-reverted-status">
                                                
                                                    <div title="The source line executed without reverting 1 times." style="color: var(--success); padding: 0;">âœ“ 1</div>
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre class="row-line-covered">         creator = msg.sender;</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">21</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre>     }</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">22</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre></pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">23</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre>     function deposit() public payable {</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">24</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre class="row-line-uncovered">         assert(balances[msg.sender] &#43; msg.value &gt; balances[msg.sender]);</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">25</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre class="row-line-uncovered">         balances[msg.sender] &#43;= msg.value;</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">26</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre>     }</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">27</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre></pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">28</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre>     function withdraw(uint256 amount) public {</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">29</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre class="row-line-uncovered">         require(amount &lt;= balances[msg.sender]);</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">30</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre class="row-line-uncovered">         msg.sender.transfer(amount);</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">31</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre class="row-line-uncovered">         balances[msg.sender] -= amount;</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">32</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre>     }</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">33</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre></pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">34</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre>     function refund() public {</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">35</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre>         // &lt;yes&gt; &lt;report&gt; ACCESS_CONTROL</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">36</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre class="row-line-uncovered">         msg.sender.transfer(balances[msg.sender]); // &lt;LEAKING_VUL&gt;</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">37</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre>     }</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">38</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre></pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">39</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre>     // In an emergency the owner can migrate  allfunds to a different address.</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">40</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre></pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">41</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre>     function migrateTo(address to) public {</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">42</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre class="row-line-uncovered">         require(creator == msg.sender);</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">43</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre class="row-line-uncovered">         to.transfer(this.balance);</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">44</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre>     }</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">45</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre></pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">46</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre> }</pre>
                                                
                                            </td>
                                        </tr>
                                    
                                        <tr>
                                            <td class="row-line-number">47</td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-reverted-status">
                                                
                                            </td>
                                            <td class="row-source">
                                                
                                                    <pre></pre>
                                                
                                            </td>
                                        </tr>
                                    
                                </table>
                            </div>
                        </div>
                    </div>
                
            </div>
        </div>

        
        <footer>
            <div>Report generated by Medusa on January 17, 2026 at 08:08:53 UTC</div>
            <div style="margin-top: 0.5rem">
                <a href="https://github.com/crytic/medusa" target="_blank">github.com/crytic/medusa</a>
            </div>
        </footer>
    </div>

    <script>
        
        document.addEventListener('DOMContentLoaded', () => {
            initSourceFileExpansion();
            initializeFileTree();
            initResizer();
        });
        
        
        function initSourceFileExpansion() {
            document.querySelectorAll('.source-file').forEach(file => {
                const header = file.querySelector('.source-file-header');
                header.addEventListener('click', () => {
                    file.classList.toggle('expanded');
                    const chevron = header.querySelector('.chevron-icon');
                    chevron.style.transform = file.classList.contains('expanded') ? 'rotate(180deg)' : 'rotate(0)';
                });
            });
        }

        
        function initResizer() {
            const fileExplorer = document.getElementById('file-explorer');
            const resizer = document.getElementById('file-explorer-resizer');
            let startX, startWidth;
            
            
            resizer.addEventListener('mousedown', e => {
                startX = e.clientX;
                startWidth = parseInt(window.getComputedStyle(fileExplorer).width, 10);
                
                
                document.addEventListener('mousemove', handleMouseMove);
                document.addEventListener('mouseup', handleMouseUp);
                
                
                document.body.style.userSelect = 'none';
                document.body.style.cursor = 'col-resize';
            });
            
            
            function handleMouseMove(e) {
                const newWidth = startWidth + (e.clientX - startX);
                
                
                if (newWidth >= 200 && newWidth <= 500) {
                    fileExplorer.style.width = newWidth + 'px';
                    fileExplorer.style.flex = `0 0 ${newWidth}px`;
                }
            }
            
            
            function handleMouseUp() {
                document.removeEventListener('mousemove', handleMouseMove);
                document.removeEventListener('mouseup', handleMouseUp);
                document.body.style.userSelect = '';
                document.body.style.cursor = '';
            }
        }

        
        function getCoverageColor(percentage) {
            return percentage < 50 
                ? `hsl(${percentage * 1.2}, 90%, 50%)`
                : `hsl(${60 + (percentage - 50) * 1.2}, 90%, 45%)`;
        }

        
        function getCoverageColorAlpha(percentage) {
            return percentage < 50 
                ? `hsla(${percentage * 1.2}, 90%, 50%, 0.15)`
                : `hsla(${60 + (percentage - 50) * 1.2}, 90%, 45%, 0.15)`;
        }

        
        function buildFileTree() {
            const root = { name: '', type: 'directory', children: {}, path: '' };
            const sourceFiles = document.getElementsByClassName("source-file");
            
            
            for (let i = 0; i < sourceFiles.length; i++) {
                const filePath = sourceFiles[i].dataset.filePath;
                const pathParts = filePath.split(/[\/\\]+/);
                let current = root;
                let currentPath = '';
                
                for (let j = 0; j < pathParts.length; j++) {
                    const part = pathParts[j];
                    if (part === '') continue;
                    
                    currentPath += (currentPath ? '/' : '') + part;
                    
                    if (j === pathParts.length - 1) {
                        
                        current.children[part] = {
                            name: part,
                            type: 'file',
                            path: filePath,
                            element: sourceFiles[i],
                            coveredLines: parseInt(sourceFiles[i].dataset.linesCovered),
                            activeLines: parseInt(sourceFiles[i].dataset.linesActive)
                        };
                    } else {
                        
                        if (!current.children[part]) {
                            current.children[part] = {
                                name: part,
                                type: 'directory',
                                children: {},
                                path: currentPath
                            };
                        }
                        current = current.children[part];
                    }
                }
            }
            
            
            calculateDirectoryCoverage(root);
            
            return root;
        }
        
        
        function calculateDirectoryCoverage(node) {
            if (node.type === 'file') {
                return {
                    coveredLines: node.coveredLines,
                    activeLines: node.activeLines
                };
            }
            
            let totalCovered = 0;
            let totalActive = 0;
            
            for (const childName in node.children) {
                const child = node.children[childName];
                const { coveredLines, activeLines } = calculateDirectoryCoverage(child);
                totalCovered += coveredLines;
                totalActive += activeLines;
            }
            
            node.coveredLines = totalCovered;
            node.activeLines = totalActive;
            
            return {
                coveredLines: totalCovered,
                activeLines: totalActive
            };
        }
        
        
        function renderFileTree(node, parentElement, isRoot = false) {
            const list = isRoot ? parentElement : document.createElement('ul');
            
            
            const sortedChildren = Object.values(node.children).sort((a, b) => {
                if (a.type !== b.type) return a.type === 'directory' ? -1 : 1;
                return a.name.localeCompare(b.name);
            });
            
            for (const child of sortedChildren) {
                const li = document.createElement('li');
                li.className = child.type;
                
                
                const itemDiv = document.createElement('div');
                itemDiv.className = 'file-item';
                
                
                const toggle = document.createElement('span');
                toggle.className = 'file-toggle';
                itemDiv.appendChild(toggle);
                
                
                const icon = document.createElement('span');
                icon.className = 'file-icon';
                itemDiv.appendChild(icon);
                
                
                const nameSpan = document.createElement('span');
                nameSpan.className = 'file-name';
                nameSpan.textContent = child.name;
                itemDiv.appendChild(nameSpan);
                
                
                if (child.activeLines > 0) {
                    const coverage = document.createElement('span');
                    coverage.className = 'file-coverage';
                    const percentage = Math.round((child.coveredLines / child.activeLines) * 100);
                    coverage.style.backgroundColor = getCoverageColor(percentage);
                    coverage.title = `${child.coveredLines}/${child.activeLines} lines covered (${percentage}%)`;
                    itemDiv.appendChild(coverage);
                }
                
                li.appendChild(itemDiv);
                
                
                if (child.type === 'directory') {
                    toggle.addEventListener('click', e => {
                        e.stopPropagation();
                        li.classList.toggle('expanded');
                    });
                    
                    itemDiv.addEventListener('click', () => {
                        li.classList.toggle('expanded');
                    });
                    
                    
                    renderFileTree(child, li);
                } else {
                    
                    itemDiv.addEventListener('click', () => {
                        
                        document.querySelectorAll('.file-item.active').forEach(el => {
                            el.classList.remove('active');
                        });
                        
                        
                        itemDiv.classList.add('active');
                        
                        
                        const fileElement = child.element;
                        fileElement.scrollIntoView({ behavior: 'smooth' });
                        
                        
                        if (!fileElement.classList.contains('expanded')) {
                            fileElement.querySelector('.source-file-header').click();
                        }
                    });
                }
                
                list.appendChild(li);
            }
            
            if (!isRoot) {
                parentElement.appendChild(list);
            }
        }
        
        
        function initializeFileTree() {
            const fileTreeRoot = document.getElementById('file-tree-root');
            const fileTree = buildFileTree();
            renderFileTree(fileTree, fileTreeRoot, true);
            
            
            document.querySelectorAll('#file-tree-root > li.directory').forEach(dir => {
                dir.classList.add('expanded');
            });
            
            
            initializeFileSearch();
        }
        
        
        function initializeFileSearch() {
            const searchInput = document.getElementById('file-search-input');
            const clearButton = document.getElementById('file-search-clear');
            const noResultsMessage = document.getElementById('search-no-results');
            
            
            function debounce(func, delay) {
                let timeout;
                return function() {
                    const context = this;
                    const args = arguments;
                    clearTimeout(timeout);
                    timeout = setTimeout(() => func.apply(context, args), delay);
                };
            }
            
            
            function highlightText(element, searchTerm) {
                if (!searchTerm) return element.textContent;
                
                const text = element.textContent;
                const lowerText = text.toLowerCase();
                const lowerSearchTerm = searchTerm.toLowerCase();
                
                if (lowerText.includes(lowerSearchTerm)) {
                    const startIndex = lowerText.indexOf(lowerSearchTerm);
                    const endIndex = startIndex + lowerSearchTerm.length;
                    
                    const beforeMatch = text.substring(0, startIndex);
                    const match = text.substring(startIndex, endIndex);
                    const afterMatch = text.substring(endIndex);
                    
                    element.innerHTML = beforeMatch + '<span class="search-highlight">' + match + '</span>' + afterMatch;
                    return true;
                }
                
                element.textContent = text;
                return false;
            }
            
            
            function filterFileTree(searchTerm) {
                const fileTreeItems = document.querySelectorAll('.file-tree li');
                let hasVisibleItems = false;
                
                fileTreeItems.forEach(item => {
                    const nameElement = item.querySelector('.file-name');
                    const isMatch = highlightText(nameElement, searchTerm);
                    
                    if (searchTerm === '') {
                        
                        item.style.display = '';
                        
                        
                        if (item.classList.contains('directory') && !item.parentElement.classList.contains('file-tree-root')) {
                            item.classList.remove('expanded');
                        }
                    } else if (isMatch) {
                        
                        item.style.display = '';
                        hasVisibleItems = true;
                        
                        
                        let parent = item.parentElement.closest('.directory');
                        while (parent) {
                            parent.classList.add('expanded');
                            parent.style.display = '';
                            parent = parent.parentElement.closest('.directory');
                        }
                    } else {
                        
                        if (item.classList.contains('directory')) {
                            const hasVisibleChildren = Array.from(item.querySelectorAll('li')).some(
                                child => child.style.display !== 'none'
                            );
                            
                            if (hasVisibleChildren) {
                                item.style.display = '';
                                hasVisibleItems = true;
                            } else {
                                item.style.display = 'none';
                            }
                        } else {
                            item.style.display = 'none';
                        }
                    }
                });
                
                
                noResultsMessage.style.display = searchTerm && !hasVisibleItems ? 'block' : 'none';
            }
            
            
            const debouncedSearch = debounce(filterFileTree, 200);
            
            
            searchInput.addEventListener('input', function() {
                debouncedSearch(this.value.trim());
            });
            
            
            clearButton.addEventListener('click', function() {
                searchInput.value = '';
                filterFileTree('');
                searchInput.focus();
            });
        }
        
        
        function setAllSourceFilesCollapsed(collapsed) {
            document.querySelectorAll('.source-file').forEach(file => {
                if ((collapsed && file.classList.contains('expanded')) || 
                    (!collapsed && !file.classList.contains('expanded'))) {
                    file.querySelector('.source-file-header').click();
                }
            });
        }
        
        
        function setEmptySourceFilesCollapsed(collapsed) {
            document.querySelectorAll('.source-file').forEach(file => {
                if (parseInt(file.dataset.linesActive) <= 0) {
                    if ((collapsed && file.classList.contains('expanded')) || 
                        (!collapsed && !file.classList.contains('expanded'))) {
                        file.querySelector('.source-file-header').click();
                    }
                }
            });
        }
    </script>
</body>
</html>
